# ビルド関連
- .apt_generatedをビルドパスに入れる
- デフォルト出力フォルダを１つにする

# 実装上の仕様

## ログイン
Spring-Securityによる実装。

## 検索処理
- 検索条件を保持する。
- 検索条件のためのEntityを作成。
- データ変更等の処理はこのEntityを継承する

### Doma2向けFormスーパークラス
- p,c,dは数値が入るが型は文字型
- Controller内でページャ処理で数値型として扱う
- Controllerのスーパークラスで型変換する方針に
- formオブジェクトは基本的にStringで
  * BeanUtilsで型変換を行う

#### スーパークラスから切り離す予定
- テンプレート操作系
  * 共有するページャーで用いる設定を入れる
  * javascript取り込み
  * css取り込み
  * いろんなものをModelオブジェクトに格納する最終処理

## ページャのリンク
- formにページ数・ソート項目・ソート方向を設定
- これをsubmit(get)
- CSRFトークンは飛ばさなくて良い


# 処理全般

## キーワード検索
- キーワードは、名称・カテゴリー名・詳細を部分一致で検索
- ページは１ページ目を表示
- ソート順は直前のものを使用
- 検索条件等はシリアライズして渡す
- 前画面に戻る場合はデシリアライズする

## 登録
- 新画面へ遷移する
- Validation（入力系・形式系・複数項目系）
- 登録後は、直近の検索条件で読み直す

## 更新
- 新画面へ遷移する
- Validation（入力系・形式系・複数項目系）
- 登録後は、直近の検索条件で読み直す

## 削除
- 削除確認を疑似ダイアログで表示
- 削除後は直近の検索条件で検索
- リダイレクトによる多重登録を防止するため、flashAttirbuteで検索条件と前画面の条件を一式渡す


# ターム管理について

## 表示仕様
- タクソノミーID（親ID）を選択した状態として表示
- タームの追加等はすべて同じタクソノミーIDとして実行
- この画面からタクソノミーIDの変更を行わないものとする。

## パラメータ送受信
- タクソノミー管理で親IDを取得
- タームのダイアログには常に親IDを渡す

# formオブジェクトの使い分け

## searchForm
検索を行うためのフォーム
CSRFトークンは存在しない
そのためget送信して検索を行う
削除時にリダイレクトをするため、前画面のページャ・検索条件のクエリストリングを持っている

### パラメータ
- p:ページ
- c:ソートカラム（チルダ区切り）
- d:ソート方向（チルダ区切り）
- その他:検索条件を各種設定

## procForm
データ操作系を行うためのフォーム
CSRFトークンを付与する
検索条件と前画面のクエリストリングを持つ

## nextForm
次の画面に渡すためのフォーム
キー情報と今の検索条件・ページャの情報をgetで渡す

## その他予定
ショッピングカートの決済画面のような順番を必要とする画面はuriに設定を書かせないためにpostで渡す必要がある

# 独自実装

## BindingResultの拡張
JSR-303ではValidationの出力順はランダムのためこれをアノテーション設定順に変える

- bindingResult.getAllErrors()ですべてのエラーを取得し、エラーが発生したアノテーションを取得できる

```java
List<FieldError> fe = bindingResult.getFieldErrors();
for (FieldError e : fe) {
	System.out.println(e.getField() + ":" + e.getCode());
}
```

ValidationErrorSotringUtilユーテリティクラスで並べ替えを行う。